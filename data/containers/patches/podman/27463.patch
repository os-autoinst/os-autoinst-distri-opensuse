From 4bc3a1960109fab006b1c1e585beebe0c1b0eeb4 Mon Sep 17 00:00:00 2001
From: Ricardo Branco <rbranco@suse.de>
Date: Fri, 7 Nov 2025 09:33:59 +0100
Subject: [PATCH] test/system: Update test to handle new error message from
 runc 1.3.3

Signed-off-by: Ricardo Branco <rbranco@suse.de>
---
 test/system/410-selinux.bats | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/test/system/410-selinux.bats b/test/system/410-selinux.bats
index f360e91446a..ac5716c7f13 100644
--- a/test/system/410-selinux.bats
+++ b/test/system/410-selinux.bats
@@ -255,11 +255,7 @@ function check_label() {
         #   from /proc/thread-self/attr/exec`: .* unable to assign
         #   to   /proc/self/attr/keycreate`: .* unable to process
         crun) expect="\`/proc/.*\`: OCI runtime error: unable to \(assign\|process\) security attribute" ;;
-        # runc 1.1 changed the error message because of new selinux pkg that uses standard os.PathError, see
-        # https://github.com/opencontainers/selinux/pull/148/commits/a5dc47f74c56922d58ead05d1fdcc5f7f52d5f4e
-        #   from failed to set /proc/self/attr/keycreate on procfs
-        #   to   write /proc/self/attr/keycreate: invalid argument
-        runc) expect=".*: \(failed to set\|write\) /proc/self/attr/keycreate.*" ;;
+        runc) expect=".*: \(failed\|write\).*proc/self/attr/keycreate.*" ;;
         *)    skip "Unknown runtime '$runtime'";;
     esac
 
