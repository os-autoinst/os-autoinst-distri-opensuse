name: selinux
description: >
    This is for SElinux test
schedule:
    - '{{boot}}'
    - security/selinux/selinux_setup
    - security/selinux/sestatus
    - '{{selinux_enforcing}}'
    - security/selinux/semanage_fcontext
    - security/selinux/semanage_boolean
    - security/selinux/fixfiles
    - security/selinux/print_se_context
    - security/selinux/audit2allow
    - security/selinux/semodule
    - security/selinux/setsebool
    - security/selinux/restorecon
    - security/selinux/chcon
    - security/selinux/chcat
    - security/selinux/set_get_enforce
    - security/selinux/selinuxexeccon
conditional_schedule:
    boot:
        DISTRI:
            alp:
                - microos/disk_boot
                - update/zypper_clear_repos
                - console/zypper_ar
                - console/zypper_ref
                - transactional/host_config
                - transactional/enable_selinux
            sle:
                - installation/bootloader_start
                - boot/boot_to_desktop
            opensuse:
                - installation/bootloader_start
                - boot/boot_to_desktop

    selinux_enforcing:
        DISTRI:
            opensuse:
                - security/selinux/selinux_smoke
                - security/selinux/enforcing_mode_setup
            sle:
                - security/selinux/selinux_smoke
                - security/selinux/enforcing_mode_setup
