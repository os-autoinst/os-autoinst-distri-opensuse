name:           ha_qnetd_server
description:    >
  Create a qnetd server for testing qnet/device (corosync quorum feature)

  This schedule corresponds to the job that provides the qnetd server for the
  qnetd/qdevice multi-machine cluster test.  It must be scheduled PARALLEL_WITH
  a support server, as well as the jobs providing the cluster nodes. Some
  settings are defined here in the schedule, while others are required outside
  of it.

  The following settings must be defined outside of the schedule, either in
  the job group yaml configuration or in a test suite.

  CLUSTER_NAME defining a name for the cluster test, for example qdevice. Only
  use characters permitted by DNS in this name
  HDD_1 pointing to a qcow2 image generated by created_hdd_ha_textmode
  NICTYPE and WORKER_CLASS must be set to 'tap' in the job group directly in qemu based jobs.
  PARALLEL_WITH pointing to the name of the support server job
  SLE_PRODUCT with the product being tested
  UEFI_PFLASH_VARS pointing to a qcow2 image with the UEFI vars generated
  by create_hdd_ha_textmode (if necessary)
  YAML_SCHEDULE set to schedule/ha/bv/ha_qnetd_server.yaml
vars:
  # Boot qcow2 image generated by create_hdd_ha_textmode
  BOOT_HDD_IMAGE: "1"
  DESKTOP: textmode
  HA_CLUSTER: "1"
  HDDMODEL: scsi-hd
  HOSTNAME: "%CLUSTER_NAME%-node03"
  # Number of nodes. This setting is required here and in the support server job
  NUM_NODES: "2"
  # qdevice test role is qnetd_server here and client in the cluster nodes
  QDEVICE_TEST_ROLE: qnetd_server
  USE_SUPPORT_SERVER: "1"
schedule:
  - boot/boot_to_desktop
  - console/system_prepare
  - console/consoletest_setup
  - console/check_os_release
  - console/hostname
  - ha/firewall_disable
  - ha/qnetd
